{
	"$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"disks_centos7_test_vm_name": {
			"defaultValue": "centos7-test-vm",
			"type": "String"
		},
		"virtualMachines_centos7_test_vm_name": {
			"defaultValue": "centos7-test-vm",
			"type": "String"
		},
		"networkInterfaces_centos7_test_vm366_name": {
			"defaultValue": "centos7-test-vm366",
			"type": "String"
		},
		"networkSecurityGroups_centos7_test_vm_nsg_name": {
			"defaultValue": "centos7-test-vm-nsg",
			"type": "String"
		},
		"publicIPAddresses_centos7_test_vm_ip_name": {
			"defaultValue": "centos7-test-vm-ip",
			"type": "String"
		},
		"virtualNetworks_CentOSTestRG_vnet_name": {
			"defaultValue": "CentOSTestRG-vnet",
			"type": "String"
		}
	},
	"variables": {},

	"resources": [{
			"type": "Microsoft.Compute/disks",
			"name": "[parameters('disks_centos7_test_vm_name')]",
			"apiVersion": "2016-04-30-preview",
			"location": "eastus2",
			"properties": {
				"accountType": "Standard_LRS",
				"osType": "Linux",
				"creationData": {
					"createOption": "FromImage",
					"imageReference": {
						"id": "/Subscriptions/ce6c1bf1-74b9-47e9-a1a3-c26922dd34db/Providers/Microsoft.Compute/Locations/eastus2/Publishers/OpenLogic/ArtifactTypes/VMImage/Offers/CentOS/Skus/7.3/Versions/latest"
					}
				},
				"diskSizeGB": 31
			},
			"dependsOn": []
		},
		{
			"type": "Microsoft.Compute/virtualMachines",
			"name": "[parameters('virtualMachines_centos7_test_vm_name')]",
			"apiVersion": "2016-04-30-preview",
			"location": "eastus2",
			"properties": {
				"hardwareProfile": {
					"vmSize": "Basic_A2"
				},
				"storageProfile": {
					"imageReference": {
						"publisher": "OpenLogic",
						"offer": "CentOS",
						"sku": "7.3",
						"version": "latest"
					},
					"osDisk": {
						"osType": "Linux",
						"name": "[parameters('virtualMachines_centos7_test_vm_name')]",
						"createOption": "FromImage",
						"caching": "ReadWrite",
						"managedDisk": {
							"storageAccountType": "Standard_LRS",
							"id": "[resourceId('Microsoft.Compute/disks', parameters('disks_centos7_test_vm_name'))]"
						},
						"diskSizeGB": 31
					},
					"dataDisks": []
				},
				"osProfile": {
					"computerName": "[parameters('virtualMachines_centos7_test_vm_name')]",
					"adminUsername": "stkirk",
					"linuxConfiguration": {
						"disablePasswordAuthentication": true,
						"ssh": {
							"publicKeys": [{
								"path": "/home/stkirk/.ssh/authorized_keys",
								"keyData": "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC85TmNfF+G5Mc9LPL9pztyoiwJ3wp/YQu0WKXWJZVFgkdCZRM9zJiTpmtUF69Q5kjzVKEv892vhLIX8WFcGQ8+4EDRBh1HawB4lHi6bGQoSC/pmmrXxw7erjDMiG4SXXNqUZlzYkjgxsnx0Yn0bySIG3Jw+b0C0EG5JNpt/S1/tYlXIyv1oDA1GdrGwmmpegaMb6t492t9xk5rmnenklxgqrTgfkMnYM6JQqW5lrOmUvACgQBnoVwE/2Gklgv6Cd1ozKkupV3OPudDmpoAN2Po1GA+835Ksu1R0DxSrMjU1Y8KCCekf8jPiu/PtszzDa1pWVAU/f0p0TzUXKIIh5eJ"
							}]
						}
					},
					"secrets": []
				},
				"networkProfile": {
					"networkInterfaces": [{
						"id": "[resourceId('Microsoft.Network/networkInterfaces', parameters('networkInterfaces_centos7_test_vm366_name'))]"
					}]
				}
			},
			"dependsOn": [
				"[resourceId('Microsoft.Compute/disks', parameters('disks_centos7_test_vm_name'))]",
				"[resourceId('Microsoft.Network/networkInterfaces', parameters('networkInterfaces_centos7_test_vm366_name'))]"
			]
		},
		{
			"type": "Microsoft.Network/networkInterfaces",
			"name": "[parameters('networkInterfaces_centos7_test_vm366_name')]",
			"apiVersion": "2016-03-30",
			"location": "eastus2",
			"properties": {
				"ipConfigurations": [{
					"name": "ipconfig1",
					"properties": {
						"privateIPAddress": "10.3.0.4",
						"privateIPAllocationMethod": "Dynamic",
						"publicIPAddress": {
							"id": "[resourceId('Microsoft.Network/publicIPAddresses', parameters('publicIPAddresses_centos7_test_vm_ip_name'))]"
						},
						"subnet": {
							"id": "[concat(resourceId('Microsoft.Network/virtualNetworks', parameters('virtualNetworks_CentOSTestRG_vnet_name')), '/subnets/default')]"
						}
					}
				}],
				"dnsSettings": {
					"dnsServers": []
				},
				"enableIPForwarding": false,
				"networkSecurityGroup": {
					"id": "[resourceId('Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroups_centos7_test_vm_nsg_name'))]"
				}
			},
			"dependsOn": [
				"[resourceId('Microsoft.Network/publicIPAddresses', parameters('publicIPAddresses_centos7_test_vm_ip_name'))]",
				"[resourceId('Microsoft.Network/virtualNetworks', parameters('virtualNetworks_CentOSTestRG_vnet_name'))]",
				"[resourceId('Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroups_centos7_test_vm_nsg_name'))]"
			]
		},
		{
			"type": "Microsoft.Network/networkSecurityGroups",
			"name": "[parameters('networkSecurityGroups_centos7_test_vm_nsg_name')]",
			"apiVersion": "2016-03-30",
			"location": "eastus2",
			"properties": {
				"securityRules": [{
					"name": "default-allow-ssh",
					"properties": {
						"protocol": "TCP",
						"sourcePortRange": "*",
						"destinationPortRange": "22",
						"sourceAddressPrefix": "*",
						"destinationAddressPrefix": "*",
						"access": "Allow",
						"priority": 1000,
						"direction": "Inbound"
					}
				}]
			},
			"dependsOn": []
		},
		{
			"type": "Microsoft.Network/publicIPAddresses",
			"name": "[parameters('publicIPAddresses_centos7_test_vm_ip_name')]",
			"apiVersion": "2016-03-30",
			"location": "eastus2",
			"properties": {
				"publicIPAllocationMethod": "Dynamic",
				"idleTimeoutInMinutes": 4
			},
			"dependsOn": []
		},
		{
			"type": "Microsoft.Network/virtualNetworks",
			"name": "[parameters('virtualNetworks_CentOSTestRG_vnet_name')]",
			"apiVersion": "2016-03-30",
			"location": "eastus2",
			"properties": {
				"addressSpace": {
					"addressPrefixes": [
						"10.3.0.0/24"
					]
				},
				"subnets": [{
					"name": "default",
					"properties": {
						"addressPrefix": "10.3.0.0/24"
					}
				}]
			},
			"dependsOn": []
		}
	]
}
